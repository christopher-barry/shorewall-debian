'\" t
.\"     Title: shorewall6-rules
.\"    Author: [FIXME: author] [see http://docbook.sf.net/el/author]
.\" Generator: DocBook XSL Stylesheets v1.75.1 <http://docbook.sf.net/>
.\"      Date: 11/01/2009
.\"    Manual: [FIXME: manual]
.\"    Source: [FIXME: source]
.\"  Language: English
.\"
.TH "SHOREWALL6\-RULES" "5" "11/01/2009" "[FIXME: source]" "[FIXME: manual]"
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
rules \- Shorewall6 rules file
.SH "SYNOPSIS"
.HP \w'\fB/etc/shorewall6/rules\fR\ 'u
\fB/etc/shorewall6/rules\fR
.SH "DESCRIPTION"
.PP
Entries in this file govern connection establishment by defining exceptions to the policies layed out in
\m[blue]\fBshorewall6\-policy\fR\m[]\&\s-2\u[1]\d\s+2(5)\&. By default, subsequent requests and responses are automatically allowed using connection tracking\&. For any particular (source,dest) pair of zones, the rules are evaluated in the order in which they appear in this file and the first terminating match is the one that determines the disposition of the request\&. All rules are terminating except LOG and QUEUE rules\&.
.PP
The rules file is divided into sections\&. Each section is introduced by a "Section Header" which is a line beginning with SECTION and followed by the section name\&.
.PP
Sections are as follows and must appear in the order listed:
.PP
\fBESTABLISHED\fR
.RS 4
Packets in the ESTABLISHED state are processed by rules in this section\&.
.sp
The only ACTIONs allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE
.sp
There is an implicit ACCEPT rule inserted at the end of this section\&.
.RE
.PP
\fBRELATED\fR
.RS 4
Packets in the RELATED state are processed by rules in this section\&.
.sp
The only ACTIONs allowed in this section are ACCEPT, DROP, REJECT, LOG and QUEUE
.sp
There is an implicit ACCEPT rule inserted at the end of this section\&.
.RE
.PP
\fBNEW\fR
.RS 4
Packets in the NEW, INVALID and UNTRACKED states are processed by rules in this section\&.
.RE
.if n \{\
.sp
.\}
.RS 4
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBNote\fR
.ps -1
.br
.PP
If you are not familiar with Netfilter to the point where you are comfortable with the differences between the various connection tracking states, then it is suggested that you omit the
\fBESTABLISHED\fR
and
\fBRELATED\fR
sections and place all of your rules in the NEW section (That\'s after the line that reads SECTION NEW\')\&.
.sp .5v
.RE
.if n \{\
.sp
.\}
.RS 4
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBWarning\fR
.ps -1
.br
.PP
If you specify FASTACCEPT=Yes in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5) then the
\fBESTABLISHED\fR
and
\fBRELATED\fR
sections must be empty\&.
.sp .5v
.RE
.PP
You may omit any section that you don\'t need\&. If no Section Headers appear in the file then all rules are assumed to be in the NEW section\&.
.PP
The columns in the file are as follows\&.
.PP
\fBACTION\fR \- {\fBACCEPT\fR[\fB\fB+\fR\fR\fB|\fR\fB\fB!\fR\fR]|\fBDROP[\fR\fB\fB!\fR\fR\fB]\fR|\fBREJECT\fR[\fB!\fR]|\fBDNAT\fR[\fB\-\fR]|\fBSAME\fR[\fB\-\fR]|\fBCONTINUE\fR[\fB!\fR]|\fBLOG\fR|\fBQUEUE\fR[\fB!\fR]|\fBNFQUEUE\fR[\fB(\fR\fIqueuenumber\fR\fB)\fR]\fB|COMMENT\fR|\fIaction\fR|\fImacro\fR[\fB(\fR\fItarget\fR\fB)\fR]}\fB[:\fR{\fIlog\-level\fR|\fBnone\fR}[\fB\fB!\fR\fR][\fB:\fR\fItag\fR]]
.RS 4
Specifies the action to be taken if the connection request matches the rule\&. Must be one of the following\&.
.PP
\fBACCEPT\fR
.RS 4
Allow the connection request\&.
.RE
.PP
\fBACCEPT!\fR
.RS 4
like ACCEPT but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
\fBDROP\fR
.RS 4
Ignore the request\&.
.RE
.PP
\fBDROP!\fR
.RS 4
like DROP but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
\fBREJECT\fR
.RS 4
disallow the request and return an icmp\-unreachable or an RST packet\&.
.RE
.PP
\fBREJECT!\fR
.RS 4
like REJECT but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
\fBCONTINUE\fR
.RS 4
For experts only\&.
.sp
Do not process any of the following rules for this (source zone,destination zone)\&. If the source and/or destination IP address falls into a zone defined later in
\m[blue]\fBshorewall6\-zones\fR\m[]\&\s-2\u[3]\d\s+2(5) or in a parent zone of the source or destination zones, then this connection request will be passed to the rules defined for that (those) zone(s)\&. See
\m[blue]\fBshorewall6\-nesting\fR\m[]\&\s-2\u[4]\d\s+2(5) for additional information\&.
.RE
.PP
\fBCONTINUE!\fR
.RS 4
like CONTINUE but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
\fBLOG\fR
.RS 4
Simply log the packet and continue with the next rule\&.
.RE
.PP
\fBQUEUE\fR
.RS 4
Queue the packet to a user\-space application such as ftwall (http://p2pwall\&.sf\&.net)\&. The application may reinsert the packet for further processing\&.
.RE
.PP
\fBQUEUE!\fR
.RS 4
like QUEUE but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
NFQUEUE
.RS 4
Queues the packet to a user\-space application using the nfnetlink_queue mechanism\&. If a
\fIqueuenumber\fR
is not specified, queue zero (0) is assumed\&.
.RE
.PP
\fBNFQUEUE!\fR
.RS 4
like NFQUEUE but exempts the rule from being suppressed by OPTIMIZE=1 in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5)\&.
.RE
.PP
\fBCOMMENT\fR
.RS 4
the rest of the line will be attached as a comment to the Netfilter rule(s) generated by the following entries\&. The comment will appear delimited by "/* \&.\&.\&. */" in the output of "shorewall6 show <chain>"\&. To stop the comment from being attached to further rules, simply include COMMENT on a line by itself\&.
.RE
.PP
\fIaction\fR
.RS 4
The name of an
\fIaction\fR
declared in
\m[blue]\fBshorewall6\-actions\fR\m[]\&\s-2\u[5]\d\s+2(5) or in /usr/share/shorewall6/actions\&.std\&.
.RE
.PP
\fImacro\fR
.RS 4
The name of a macro defined in a file named macro\&.\fImacro\fR\&. If the macro accepts an action parameter (Look at the macro source to see if it has PARAM in the TARGET column) then the
\fImacro\fR
name is followed by the parenthesized
\fItarget\fR
(\fBACCEPT\fR,
\fBDROP\fR,
\fBREJECT\fR, \&.\&.\&.) to be substituted for the parameter\&.
.sp
Example: FTP(ACCEPT)\&.
.sp
The older syntax where the macro name and the target are separated by a slash (e\&.g\&. FTP/ACCEPT) is still allowed but is deprecated\&.
.sp
.if n \{\
.RS 4
.\}
.nf
.fi
.if n \{\
.RE
.\}
.RE
.sp
The
\fBACTION\fR
may optionally be followed by ":" and a syslog log level (e\&.g, REJECT:info or ACCEPT:debug)\&. This causes the packet to be logged at the specified level\&.
.sp
If the
\fBACTION\fR
names an
\fIaction\fR
declared in
\m[blue]\fBshorewall6\-actions\fR\m[]\&\s-2\u[5]\d\s+2(5) or in /usr/share/shorewall6/actions\&.std then:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
If the log level is followed by "!\' then all rules in the action are logged at the log level\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
If the log level is not followed by "!" then only those rules in the action that do not specify logging are logged at the specified level\&.
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
The special log level
\fBnone!\fR
suppresses logging by the action\&.
.RE
.RS 4
You may also specify
\fBNFLOG\fR
(must be in upper case) as a log level\&.This will log to the NFLOG target for routing to a separate log through use of ulogd (\m[blue]\fBhttp://www\&.netfilter\&.org/projects/ulogd/index\&.html\fR\m[])\&.
.sp
Actions specifying logging may be followed by a log tag (a string of alphanumeric characters) which is appended to the string generated by the LOGPREFIX (in
\m[blue]\fBshorewall6\&.conf\fR\m[]\&\s-2\u[2]\d\s+2(5))\&.
.sp
Example: ACCEPT:info:ftp would include \'ftp \' at the end of the log prefix generated by the LOGPREFIX setting\&.
.RE
.PP
\fBSOURCE\fR \- {\fIzone\fR|\fBall\fR[\fB+\fR][\fB\-\fR]}\fB[:\fR\fIinterface\fR][\fB:\fR\fB\fB<\fR\fR{\fIaddress\-or\-range\fR[,\fIaddress\-or\-range\fR]\&.\&.\&.[\fIexclusion\fR]\fB>\fR|\fIexclusion\fR|\fB+\fR\fIipset\fR}
.RS 4
Source hosts to which the rule applies\&. May be a zone declared in /etc/shorewall6/zones,
\fB$FW\fR
to indicate the firewall itself,
\fBall\fR,
\fBall+\fR,
\fBall\-\fR,
\fBall+\-\fR
or
\fBnone\fR\&.
.sp
When
\fBnone\fR
is used either in the
\fBSOURCE\fR
or
\fBDEST\fR
column, the rule is ignored\&.
.sp
\fBall\fR
means "All Zones", including the firewall itself\&.
\fBall\-\fR
means "All Zones, except the firewall itself"\&. When
\fBall\fR[\fB\-\fR] is used either in the
\fBSOURCE\fR
or
\fBDEST\fR
column intra\-zone traffic is not affected\&. When
\fBall+\fR[\fB\-\fR] is "used, intra\-zone traffic is affected\&.
.sp
Except when
\fBall\fR[\fB+\fR][\fB\-\fR] is specified, clients may be further restricted to a list of networks and/or hosts by appending ":" and a comma\-separated list of network and/or host addresses\&. Hosts may be specified by IP or MAC address; mac addresses must begin with "~" and must use "\-" as a separator\&.
.sp
Hosts may also be specified as an IP address range using the syntax
\fIlowaddress\fR\-\fIhighaddress\fR\&. This requires that your kernel and ip6tables contain iprange match support\&. If your kernel and ip6tables have ipset match support then you may give the name of an ipset prefaced by "+"\&. The ipset name may be optionally followed by a number from 1 to 6 enclosed in square brackets ([]) to indicate the number of levels of source bindings to be matched\&.
.sp
When an
\fIinterface\fR
is not specified, you may omit the angled brackets (\'<\' and \'>\') around the address(es) or you may supply them to improve readability\&.
.sp
You may exclude certain hosts from the set already defined through use of an
\fIexclusion\fR
(see
\m[blue]\fBshorewall6\-exclusion\fR\m[]\&\s-2\u[6]\d\s+2(5))\&.
.sp
Examples:
.PP
dmz:2002:ce7c::92b4:1::2
.RS 4
Host 2002:ce7c:92b4:1::2 in the DMZ
.RE
.PP
net:2001:4d48:ad51:24::/64
.RS 4
Subnet 2001:4d48:ad51:24::/64 on the Internet
.RE
.PP
loc:<2002:cec792b4:1::2,2002:cec792b4:1::44>
.RS 4
Hosts 2002:cec792b4:1::2 and 2002:cec792b4:1::44 in the local zone\&.
.RE
.PP
loc:~00\-A0\-C9\-15\-39\-78
.RS 4
Host in the local zone with MAC address 00:A0:C9:15:39:78\&.
.RE
.PP
net:2001:4d48:ad51:24::/64!2001:4d48:ad51:24:6:/80!2001:4d48:ad51:24:6:/80
.RS 4
Subnet 2001:4d48:ad51:24::/64 on the Internet except for 2001:4d48:ad51:24:6:/80\&.
.RE
.sp
Alternatively, clients may be specified by interface by appending ":" to the zone name followed by the interface name\&. For example,
\fBloc:eth1\fR
specifies a client that communicates with the firewall system through eth1\&. This may be optionally followed by another colon (":") and an IP/MAC/subnet address as described above (e\&.g\&.,
\fBloc:eth1:<2002:ce7c::92b4:1::2>\fR)\&.
Examples:
.PP
loc:eth1:<2002:cec792b4:1::2,2002:cec792b4:1::44>
.RS 4
Hosts 2002:cec792b4:1::2 and 2002:cec792b4:1::44 in the Local zone, with
\fBboth\fR
originating from eth1
.RE
.RE
.PP
\fB\fBDEST\fR\fR\fB \- {\fR\fB\fIzone\fR\fR\fB|\fR\fB\fBall\fR\fR\fB[\fR\fB\fB+\fR\fR\fB][\fR\fB\fB\-\fR\fR\fB]}\fR\fB\fB[:\fR\fR\fB\fIinterface\fR\fR\fB][\fR\fB\fB:\fR\fB\fB<\fR\fR\fR\fB{\fR\fB\fIaddress\-or\-range\fR\fR\fB[,\fR\fB\fIaddress\-or\-range\fR\fR\fB]\&.\&.\&.[\fR\fB\fIexclusion\fR\fR\fB]\fR\fB\fB>\fR\fR\fB|\fR\fB\fIexclusion\fR\fR\fB|\fR\fB\fB+\fR\fR\fB\fIipset\fR\fR\fB}\fR
.RS 4
Location of Server\&. May be a zone declared in
\m[blue]\fBshorewall6\-zones\fR\m[]\&\s-2\u[3]\d\s+2(5), $\fBFW\fR
to indicate the firewall itself,
\fBall\fR\&.
\fBall+\fR
or
\fBnone\fR\&.
.sp
When
\fBnone\fR
is used either in the
\fBSOURCE\fR
or
\fBDEST\fR
column, the rule is ignored\&.
.sp
When
\fBall\fR
is used either in the
\fBSOURCE\fR
or
\fBDEST\fR
column intra\-zone traffic is not affected\&. When
\fBall+\fR
is used, intra\-zone traffic is affected\&.
.sp
If the DEST
\fIzone\fR
is a bport zone, then either:
.sp
.RS 4
.ie n \{\
\h'-04' 1.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  1." 4.2
.\}
the SOURCE must be
\fBall[+][\-]\fR, or
.RE
.sp
.RS 4
.ie n \{\
\h'-04' 2.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  2." 4.2
.\}
the SOURCE
\fIzone\fR
must be another bport zone associated with the same bridge, or
.RE
.sp
.RS 4
.ie n \{\
\h'-04' 3.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  3." 4.2
.\}
the SOURCE
\fIzone\fR
must be an ipv4 zone that is associated with only the same bridge\&.
.RE
.RS 4

Except when
\fBall\fR[\fB+]|[\-\fR] is specified, the server may be further restricted to a particular network, host or interface by appending ":" and the network, host or interface\&. See
\fBSOURCE\fR
above\&.
.sp
You may exclude certain hosts from the set already defined through use of an
\fIexclusion\fR
(see
\m[blue]\fBshorewall6\-exclusion\fR\m[]\&\s-2\u[6]\d\s+2(5))\&.
.sp
Restrictions:
.sp
1\&. MAC addresses are not allowed (this is a Netfilter restriction)\&.
.sp
If you kernel and ip6tables have ipset match support then you may give the name of an ipset prefaced by "+"\&. The ipset name may be optionally followed by a number from 1 to 6 enclosed in square brackets ([]) to indicate the number of levels of destination bindings to be matched\&. Only one of the
\fBSOURCE\fR
and
\fBDEST\fR
columns may specify an ipset name\&.
.RE
.PP
\fBPROTO\fR (Optional) \- {\fB\-\fR|\fBtcp:syn\fR|\fBipp2p\fR|\fBipp2p:udp\fR|\fBipp2p:all\fR|\fIprotocol\-number\fR|\fIprotocol\-name\fR|\fBall}\fR
.RS 4
Protocol \-
\fBipp2p\fR* requires ipp2p match support in your kernel and ip6tables\&.
\fBtcp:syn\fR
implies
\fBtcp\fR
plus the SYN flag must be set and the RST,ACK and FIN flags must be reset\&.
.RE
.PP
\fBDEST PORT(S) \fR(Optional) \- {\fB\-\fR|\fIport\-name\-number\-or\-range\fR[\fB,\fR\fIport\-name\-number\-or\-range\fR]\&.\&.\&.}
.RS 4
Destination Ports\&. A comma\-separated list of Port names (from services(5)), port numbers or port ranges; if the protocol is
\fBicmp\fR, this column is interpreted as the destination icmp\-type(s)\&.
.sp
If the protocol is
\fBipp2p\fR, this column is interpreted as an ipp2p option without the leading "\-\-" (example
\fBbit\fR
for bit\-torrent)\&. If no port is given,
\fBipp2p\fR
is assumed\&.
.sp
A port range is expressed as
\fIlowport\fR:\fIhighport\fR\&.
.sp
This column is ignored if
\fBPROTO\fR
=
\fBall\fR
but must be entered if any of the following columns are supplied\&. In that case, it is suggested that this field contain a dash (\fB\-\fR)\&.
.sp
If your kernel contains multi\-port match support, then only a single Netfilter rule will be generated if in this list and the
\fBCLIENT PORT(S)\fR
list below:
.sp
1\&. There are 15 or less ports listed\&.
.sp
2\&. No port ranges are included or your kernel and ip6tables contain extended multiport match support\&.
.RE
.PP
\fBSOURCE PORT(S)\fR (Optional) \- {\fB\-\fR|\fIport\-name\-number\-or\-range\fR[\fB,\fR\fIport\-name\-number\-or\-range\fR]\&.\&.\&.}
.RS 4
Port(s) used by the client\&. If omitted, any source port is acceptable\&. Specified as a comma\- separated list of port names, port numbers or port ranges\&.
.if n \{\
.sp
.\}
.RS 4
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
.ps +1
\fBWarning\fR
.ps -1
.br
Unless you really understand IP, you should leave this column empty or place a dash (\fB\-\fR) in the column\&. Most people who try to use this column get it wrong\&.
.sp .5v
.RE
If you don\'t want to restrict client ports but need to specify a later column, then place "\-" in this column\&.
.sp
If your kernel contains multi\-port match support, then only a single Netfilter rule will be generated if in this list and the
\fBDEST PORT(S)\fR
list above:
.sp
1\&. There are 15 or less ports listed\&.
.sp
2\&. No port ranges are included or your kernel and ip6tables contain extended multiport match support\&.
.RE
.PP
\fBORIGINAL DEST\fR (Optional) \- [\fB\-\fR]
.RS 4
Included for compatibility with Shorewall\&. Enter \'\-\' in this column if you need to specify one of the later columns\&.
.RE
.PP
\fBRATE LIMIT\fR (Optional) \- [\fB\-\fR|[{\fIs\fR|\fBd\fR}:[[\fIname\fR]:]]]\fIrate\fR\fB/\fR{\fBsec\fR|\fBmin\fR}[:\fIburst\fR]
.RS 4
You may rate\-limit the rule by placing a value in this column:
.sp
\fIrate\fR
is the number of connections per interval (\fBsec\fR
or
\fBmin\fR) and
\fIburst\fR
is the largest burst permitted\&. If no
\fIburst\fR
is given, a value of 5 is assumed\&. There may be no no whitespace embedded in the specification\&.
.sp
Example:
\fB10/sec:20\fR
.sp
When
\fBs:\fR
or
\fBd:\fR
is specified, the rate applies per source IP address or per destination IP address respectively\&. The
\fIname\fR
may be chosen by the user and specifies a hash table to be used to count matching connections\&. If not give, the name
\fBshorewall\fR
is assumed\&. Where more than one POLICY specifies the same name, the connections counts for the rules are aggregated and the individual rates apply to the aggregated count\&.
.RE
.PP
\fBUSER/GROUP\fR (Optional) \- [\fB!\fR][\fIuser\-name\-or\-number\fR][\fB:\fR\fIgroup\-name\-or\-number\fR]
.RS 4
This column may only be non\-empty if the SOURCE is the firewall itself\&.
.sp
When this column is non\-empty, the rule applies only if the program generating the output is running under the effective
\fIuser\fR
and/or
\fIgroup\fR
specified (or is NOT running under that id if "!" is given)\&.
.sp
Examples:
.PP
joe
.RS 4
program must be run by joe
.RE
.PP
:kids
.RS 4
program must be run by a member of the \'kids\' group
.RE
.PP
!:kids
.RS 4
program must not be run by a member of the \'kids\' group
.RE
.RE
.PP
\fBMARK\fR \- [\fB!\fR]\fIvalue\fR[/\fImask\fR][\fB:C\fR]
.RS 4
Defines a test on the existing packet or connection mark\&. The rule will match only if the test returns true\&.
.sp
If you don\'t want to define a test but need to specify anything in the following columns, place a "\-" in this field\&.
.PP
!
.RS 4
Inverts the test (not equal)
.RE
.PP
\fIvalue\fR
.RS 4
Value of the packet or connection mark\&.
.RE
.PP
\fImask\fR
.RS 4
A mask to be applied to the mark before testing\&.
.RE
.PP
\fB:C\fR
.RS 4
Designates a connection mark\&. If omitted, the packet mark\'s value is tested\&.
.RE
.RE
.PP
\fBCONNLIMIT\fR \- [\fB!\fR]\fIlimit\fR[:\fImask\fR]
.RS 4
May be used to limit the number of simultaneous connections from each individual host to
\fIlimit\fR
connections\&. Requires connlimit match in your kernel and ip6tables\&. While the limit is only checked on rules specifying CONNLIMIT, the number of current connections is calculated over all current connections from the SOURCE host\&. By default, the limit is applied to each host but can be made to apply to networks of hosts by specifying a
\fImask\fR\&. The
\fImask\fR
specifies the width of a VLSM mask to be applied to the source address; the number of current connections is then taken over all hosts in the subnet
\fIsource\-address\fR/\fImask\fR\&. When\fB !\fR
is specified, the rule matches when the number of connection exceeds the
\fIlimit\fR\&.
.RE
.PP
\fBTIME\fR \- \fItimeelement\fR[&\fItimelement\fR\&.\&.\&.]
.RS 4
May be used to limit the rule to a particular time period each day, to particular days of the week or month, or to a range defined by dates and times\&. Requires time match support in your kernel and ip6tables\&.
.sp
\fItimeelement\fR
may be:
.PP
timestart=\fIhh\fR:\fImm\fR[:\fIss\fR]
.RS 4
Defines the starting time of day\&.
.RE
.PP
timestop=\fIhh\fR:\fImm\fR[:\fIss\fR]
.RS 4
Defines the ending time of day\&.
.RE
.PP
utc
.RS 4
Times are expressed in Greenwich Mean Time\&.
.RE
.PP
localtz
.RS 4
Times are expressed in Local Civil Time (default)\&.
.RE
.PP
weekdays=ddd[,ddd]\&.\&.\&.
.RS 4
where
\fIddd\fR
is one of
\fBMon\fR,
\fBTue\fR,
\fBWed\fR,
\fBThu\fR,
\fBFri\fR,
\fBSat\fR
or
\fBSun\fR
.RE
.PP
monthdays=dd[,dd],\&.\&.\&.
.RS 4
where
\fIdd\fR
is an ordinal day of the month
.RE
.PP
datestart=\fIyyyy\fR[\-\fImm\fR[\-\fIdd\fR[\fBT\fR\fIhh\fR[:\fImm\fR[:\fIss\fR]]]]]
.RS 4
Defines the starting date and time\&.
.RE
.PP
datestop=\fIyyyy\fR[\-\fImm\fR[\-\fIdd\fR[\fBT\fR\fIhh\fR[:\fImm\fR[:\fIss\fR]]]]]
.RS 4
Defines the ending date and time\&.
.RE
.RE
.SH "EXAMPLE"
.PP
Example 1:
.RS 4
Accept SMTP requests from the DMZ to the internet
.sp
.if n \{\
.RS 4
.\}
.nf
         #ACTION SOURCE  DEST PROTO      DEST    SOURCE  ORIGINAL
         #                               PORT    PORT(S) DEST
         ACCEPT  dmz     net       tcp   smtp
.fi
.if n \{\
.RE
.\}
.RE
.PP
Example 2:
.RS 4
Allow all ssh and http connection requests from the internet to local system 2002:cec792b4:1::44
.sp
.if n \{\
.RS 4
.\}
.nf
        #ACTION SOURCE  DEST                    PROTO   DEST    SOURCE  ORIGINAL
        #                                               PORT    PORT(S) DEST
        DNAT    net     loc:2002:cec792b4:1::44 tcp     ssh,http
.fi
.if n \{\
.RE
.\}
.RE
.PP
Example 3:
.RS 4
Allow http connection requests from the internet to local system 2002:cec792b4:1::44 with a limit of 3 per second and a maximum burst of 10
.sp
.if n \{\
.RS 4
.\}
.nf
        #ACTION SOURCE DEST                      PROTO  DEST  SOURCE  ORIGINAL RATE
        #                                               PORT  PORT(S) DEST     LIMIT
        DNAT    net    loc:<2002:cec792b4:1::44> tcp    http  \-       \-        3/sec:10
.fi
.if n \{\
.RE
.\}
.RE
.PP
Example 4:
.RS 4
You want to accept SSH connections to your firewall only from internet IP addresses 2002:ce7c::92b4:1::2 and 2002:ce7c::92b4:1::22
.sp
.if n \{\
.RS 4
.\}
.nf
        #ACTION  SOURCE DEST            PROTO   DEST    SOURCE  ORIGINAL
        #                                       PORT    PORT(S) DEST
        ACCEPT   net:<2002:ce7c::92b4:1::2,2002:ce7c::92b4:1::22> \e
                        $FW              tcp     22
.fi
.if n \{\
.RE
.\}
.RE
.SH "FILES"
.PP
/etc/shorewall6/rules
.SH "SEE ALSO"
.PP
shorewall6(8), shorewall6\-accounting(5), shorewall6\-actions(5), shorewall6\-blacklist(5), shorewall6\-hosts(5), shorewall6\-interfaces(5), shorewall6\-maclist(5), shorewall6\-params(5), shorewall6\-policy(5), shorewall6\-providers(5), shorewall6\-route_rules(5), shorewall6\-routestopped(5), shorewall6\&.conf(5), shorewall6\-tcclasses(5), shorewall6\-tcdevices(5), shorewall6\-tcrules(5), shorewall6\-tos(5), shorewall6\-tunnels(5), shorewall6\-zones(5)
.SH "NOTES"
.IP " 1." 4
shorewall6-policy
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6-policy.html
.RE
.IP " 2." 4
shorewall6.conf
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6.conf.html
.RE
.IP " 3." 4
shorewall6-zones
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6-zones.html
.RE
.IP " 4." 4
shorewall6-nesting
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6-nesting.html
.RE
.IP " 5." 4
shorewall6-actions
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6-actions.html
.RE
.IP " 6." 4
shorewall6-exclusion
.RS 4
\%http://www.shorewall.net/manpages6/shorewall6-exclusion.html
.RE
