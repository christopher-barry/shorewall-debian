.\"     Title: shorewall-interfaces
.\"    Author: 
.\" Generator: DocBook XSL Stylesheets v1.73.2 <http://docbook.sf.net/>
.\"      Date: 10/02/2009
.\"    Manual: 
.\"    Source: 
.\"
.TH "SHOREWALL\-INTERFACE" "5" "10/02/2009" "" ""
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
interfaces \- Shorewall interfaces file
.SH "SYNOPSIS"
.HP 26
\fB/etc/shorewall/interfaces\fR
.SH "DESCRIPTION"
.PP
The interfaces file serves to define the firewall\'s network interfaces to Shorewall\&. The order of entries in this file is not significant in determining zone composition\&.
.PP
The columns in the file are as follows\&.
.PP
\fBZONE\fR \- \fIzone\-name\fR
.RS 4
Zone for this interface\&. Must match the name of a zone declared in /etc/shorewall/zones\&. You may not list the firewall zone in this column\&.
.sp
If the interface serves multiple zones that will be defined in the
\fIshorewall\-hosts\fR\&[1](5) file, you should place "\-" in this column\&.
.sp
If there are multiple interfaces to the same zone, you must list them in separate entries\&.
.sp
Example:
.sp
.RS 4
.nf
#ZONE   INTERFACE       BROADCAST
loc     eth1            \-
loc     eth2            \-
.fi
.RE
.RE
.PP
\fBINTERFACE\fR \- \fIinterface\fR\fB[:\fR\fIport\fR\fB]\fR
.RS 4
Name of interface\&. Each interface may be listed only once in this file\&. You may NOT specify the name of a "virtual" interface (e\&.g\&., eth0:0) here; see
\fIhttp://www\&.shorewall\&.net/FAQ\&.htm#faq18\fR
.sp
You may use wildcards here by specifying a prefix followed by the plus sign ("+")\&. For example, if you want to make an entry that applies to all PPP interfaces, use \'ppp+\'; that would match ppp0, ppp1, ppp2, \&...
.sp
When using Shorewall versions before 4\&.1\&.4, care must be exercised when using wildcards where there is another zone that uses a matching specific interface\&. See
\fIshorewall\-nesting\fR\&[2](5) for a discussion of this problem\&.
.sp
Shorewall allows \'+\' as an interface name\&.
.sp
There is no need to define the loopback interface (lo) in this file\&.
.sp
If a
\fIport\fR
is given, then the
\fIinterface\fR
must have been defined previously with the
\fBbridge\fR
option\&. The OPTIONS column may not contain the following options when a
\fIport\fR
is given\&.
.IP "" 4
arp_filter
.IP "" 4
arp_ignore
.IP "" 4
bridge
.IP "" 4
log_martians
.IP "" 4
mss
.IP "" 4
optional
.IP "" 4
proxyarp
.IP "" 4
routefilter
.IP "" 4
sourceroute
.IP "" 4
upnp
.RE
.PP
\fBBROADCAST\fR (Optional) \- {\fB\-\fR|\fBdetect\fR|\fIaddress\fR[,\fIaddress\fR]\&.\&.\&.}
.RS 4
If you use the special value
\fBdetect\fR, Shorewall will detect the broadcast address(es) for you if your iptables and kernel include Address Type Match support\&.
.sp
If your iptables and/or kernel lack Address Type Match support then you may list the broadcast address(es) for the network(s) to which the interface belongs\&. For P\-T\-P interfaces, this column is left blank\&. If the interface has multiple addresses on multiple subnets then list the broadcast addresses as a comma\-separated list\&.
.sp
If you don\'t want to give a value for this column but you want to enter a value in the OPTIONS column, enter
\fB\-\fR
in this column\&.
.RE
.PP
\fBOPTIONS\fR (Optional) \- [\fIoption\fR[\fB,\fR\fIoption\fR]\&.\&.\&.]
.RS 4
A comma\-separated list of options from the following list\&. The order in which you list the options is not significant but the list should have no embedded white space\&.
.PP
\fBarp_filter[={0|1}]\fR
.RS 4
If specified, this interface will only respond to ARP who\-has requests for IP addresses configured on the interface\&. If not specified, the interface can respond to ARP who\-has requests for IP addresses on any of the firewall\'s interface\&. The interface must be up when Shorewall is started\&.
.sp
Only those interfaces with the
\fBarp_filter\fR
option will have their setting changes; the value assigned to the setting will be the value specified (if any) or 1 if no value is given\&.
.sp
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.
.RE
.PP
\fBarp_ignore\fR[=\fInumber\fR]
.RS 4
If specified, this interface will respond to arp requests based on the value of
\fInumber\fR
(defaults to 1)\&.
.sp
1 \- reply only if the target IP address is local address configured on the incoming interface
.sp
2 \- reply only if the target IP address is local address configured on the incoming interface and the sender\'s IP address is part from same subnet on this interface
.sp
3 \- do not reply for local addresses configured with scope host, only resolutions for global and link
.sp
4\-7 \- reserved
.sp
8 \- do not reply for all local addresses
.sp
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.

.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Warning
Do not specify
\fBarp_ignore\fR
for any interface involved in
\fIProxy ARP\fR\&[3]\&.
.RE
.PP
\fBblacklist\fR
.RS 4
Check packets arriving on this interface against the
\fIshorewall\-blacklist\fR\&[4](5) file\&.
.RE
.PP
\fBbridge\fR
.RS 4
Designates the interface as a bridge\&.
.RE
.PP
\fBdhcp\fR
.RS 4
Specify this option when any of the following are true:
.sp
.RS 4
\h'-04' 1.\h'+02'the interface gets its IP address via DHCP
.RE
.sp
.RS 4
\h'-04' 2.\h'+02'the interface is used by a DHCP server running on the firewall
.RE
.sp
.RS 4
\h'-04' 3.\h'+02'the interface has a static IP but is on a LAN segment with lots of DHCP clients\&.
.RE
.sp
.RS 4
\h'-04' 4.\h'+02'the interface is a
\fIsimple bridge\fR\&[5]
with a DHCP server on one port and DHCP clients on another port\&.
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
If you use
\fIShorewall\-perl for firewall/bridging\fR\&[6], then you need to include DHCP\-specific rules in
\fIshorewall\-rules\fR\&[7](8)\&. DHCP uses UDP ports 67 and 68\&.
.RE
.IP "" 4
This option allows DHCP datagrams to enter and leave the interface\&.
.RE
.PP
\fBlogmartians[={0|1}]\fR
.RS 4
Turn on kernel martian logging (logging of packets with impossible source addresses\&. It is strongly suggested that if you set
\fBroutefilter\fR
on an interface that you also set
\fBlogmartians\fR\&. Even if you do not specify the
\fBroutefilter\fR
option, it is a good idea to specify
\fBlogmartians\fR
because your distribution may be enabling route filtering without you knowing it\&.
.sp
Only those interfaces with the
\fBlogmartians\fR
option will have their setting changes; the value assigned to the setting will be the value specified (if any) or 1 if no value is given\&.
.sp
To find out if route filtering is set on a given
\fIinterface\fR, check the contents of
\fI/proc/sys/net/ipv4/conf/\fR\fI\fIinterface\fR\fR\fI/rp_filter\fR
\- a non\-zero value indicates that route filtering is enabled\&.
.sp
Example:
.sp
.RS 4
.nf
        teastep@lists:~$ \fBcat /proc/sys/net/ipv4/conf/eth0/rp_filter \fR
        1
        teastep@lists:~$ 
.fi
.RE
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.

This option may also be enabled globally in the
\fIshorewall\&.conf\fR\&[8](5) file\&.
.RE
.PP
\fBmaclist\fR
.RS 4
Connection requests from this interface are compared against the contents of
\fIshorewall\-maclist\fR\&[9](5)\&. If this option is specified, the interface must be an ethernet NIC and must be up before Shorewall is started\&.
.RE
.PP
\fBmss\fR=\fInumber\fR
.RS 4
Added in Shorewall 4\&.0\&.3\&. Causes forwarded TCP SYN packets entering or leaving on this interface to have their MSS field set to the specified
\fInumber\fR\&.
.RE
.PP
\fBnets=(\fR\fB\fInet\fR\fR\fB[,\&.\&.\&.])\fR
.RS 4
Limit the zone named in the ZONE column to only the listed networks\&. The parentheses may be omitted if only a single
\fInet\fR
is given (e\&.g\&., nets=192\&.168\&.1\&.0/24)\&. Limited broadcast to the zone is supported\&. Beginning with Shorewall 4\&.4\&.1, multicast traffic to the zone is also supported\&.
.RE
.PP
\fBnets=dynamic\fR
.RS 4
Defines the zone as
dynamic\&. Requires ipset match support in your iptables and kernel\&. See
\fIhttp://www\&.shorewall\&.net/Dynamic\&.html\fR
for further information\&.
.RE
.PP
\fBnosmurfs\fR
.RS 4
Filter packets for smurfs (packets with a broadcast address as the source)\&.
.sp
Smurfs will be optionally logged based on the setting of SMURF_LOG_LEVEL in
\fIshorewall\&.conf\fR\&[8](5)\&. After logging, the packets are dropped\&.
.RE
.PP
\fBoptional\fR
.RS 4
When
\fBoptional\fR
is specified for an interface, Shorewall will be silent when:
.sp
.RS 4
\h'-04'\(bu\h'+03'a
\fI/proc/sys/net/ipv4/conf/\fR
entry for the interface cannot be modified (including for proxy ARP)\&.
.RE
.sp
.RS 4
\h'-04'\(bu\h'+03'The first address of the interface cannot be obtained\&.
.RE
.IP "" 4

I specify
\fBoptional\fR
on interfaces to Xen virtual machines that may or may not be running when Shorewall is [re]started\&.
.sp
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Caution
Use
\fBoptional\fR
at your own risk\&. If you [re]start Shorewall when an \'optional\' interface is not available and then do a
\fBshorewall save\fR, subsequent
\fBshorewall restore\fR
and
\fBshorewall \-f start\fR
operations will instantiate a ruleset that does not support that interface, even if it is available at the time of the restore/start\&.
.RE
.PP
\fBproxyarp[={0|1}]\fR
.RS 4
Sets /proc/sys/net/ipv4/conf/\fIinterface\fR/proxy_arp\&. Do NOT use this option if you are employing Proxy ARP through entries in
\fIshorewall\-proxyarp\fR\&[10](5)\&. This option is intended solely for use with Proxy ARP sub\-networking as described at:
\fIhttp://tldp\&.org/HOWTO/Proxy\-ARP\-Subnet/index\&.html\&. \fR\&[11]
.sp
\fBNote\fR: This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.
.sp
Only those interfaces with the
\fBproxyarp\fR
option will have their setting changed; the value assigned to the setting will be the value specified (if any) or 1 if no value is given\&.
.RE
.PP
\fBrouteback\fR
.RS 4
If specified, indicates that Shorewall should include rules that allow traffic arriving on this interface to be routed back out that same interface\&. This option is also required when you have used a wildcard in the INTERFACE column if you want to allow traffic between the interfaces that match the wildcard\&.
.RE
.PP
\fBroutefilter[={0|1}]\fR
.RS 4
Turn on kernel route filtering for this interface (anti\-spoofing measure)\&.
.sp
Only those interfaces with the
\fBroutefilter\fR
option will have their setting changes; the value assigned to the setting will be the value specified (if any) or 1 if no value is given\&.
.sp
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.

This option can also be enabled globally in the
\fIshorewall\&.conf\fR\&[8](5) file\&.
.RE
.PP
\fBsourceroute[={0|1}]\fR
.RS 4
If this option is not specified for an interface, then source\-routed packets will not be accepted from that interface (sets /proc/sys/net/ipv4/conf/\fIinterface\fR/accept_source_route to 1)\&. Only set this option if you know what you are doing\&. This might represent a security risk and is not usually needed\&.
.sp
Only those interfaces with the
\fBsourceroute\fR
option will have their setting changes; the value assigned to the setting will be the value specified (if any) or 1 if no value is given\&.
.sp
.sp
.it 1 an-trap
.nr an-no-space-flag 1
.nr an-break-flag 1
.br
Note
This option does not work with a wild\-card
\fIinterface\fR
name (e\&.g\&., eth0\&.+) in the INTERFACE column\&.
.RE
.PP
\fBtcpflags\fR
.RS 4
Packets arriving on this interface are checked for certain illegal combinations of TCP flags\&. Packets found to have such a combination of flags are handled according to the setting of TCP_FLAGS_DISPOSITION after having been logged according to the setting of TCP_FLAGS_LOG_LEVEL\&.
.RE
.PP
\fBupnp\fR
.RS 4
Incoming requests from this interface may be remapped via UPNP (upnpd)\&. See
\fIhttp://www\&.shorewall\&.net/UPnP\&.html\fR\&[12]\&.
.RE
.PP
\fBupnpclient\fR
.RS 4
This option is intended for laptop users who always run Shorewall on their system yet need to run UPnP\-enabled client apps such as Transmission (BitTorrent client)\&. The option causes Shorewall to detect the default gateway through the interface and to accept UDP packets from that gateway\&. Note that, like all aspects of UPnP, this is a security hole so use this option at your own risk\&.
.RE
.RE
.SH "EXAMPLE"
.PP
Example 1:
.RS 4
Suppose you have eth0 connected to a DSL modem and eth1 connected to your local network and that your local subnet is 192\&.168\&.1\&.0/24\&. The interface gets it\'s IP address via DHCP from subnet 206\&.191\&.149\&.192/27\&. You have a DMZ with subnet 192\&.168\&.2\&.0/24 using eth2\&.
.sp
Your entries for this setup would look like:
.sp
.RS 4
.nf
#ZONE   INTERFACE BROADCAST        OPTIONS
net     eth0      206\&.191\&.149\&.223  dhcp
loc     eth1      192\&.168\&.1\&.255
dmz     eth2      192\&.168\&.2\&.255
.fi
.RE
.RE
.PP
Example 2:
.RS 4
The same configuration without specifying broadcast addresses is:
.sp
.RS 4
.nf
#ZONE   INTERFACE BROADCAST        OPTIONS
net     eth0      detect           dhcp
loc     eth1      detect
dmz     eth2      detect
.fi
.RE
.RE
.PP
Example 3:
.RS 4
You have a simple dial\-in system with no ethernet connections\&.
.sp
.RS 4
.nf
#ZONE   INTERFACE BROADCAST        OPTIONS
net     ppp0      \-
.fi
.RE
.RE
.SH "FILES"
.PP
/etc/shorewall/interfaces
.SH "SEE ALSO"
.PP
shorewall(8), shorewall\-accounting(5), shorewall\-actions(5), shorewall\-blacklist(5), shorewall\-hosts(5), shorewall\-ipsec(5), shorewall\-maclist(5), shorewall\-masq(5), shorewall\-nat(5), shorewall\-netmap(5), shorewall\-params(5), shorewall\-policy(5), shorewall\-providers(5), shorewall\-proxyarp(5), shorewall\-route_rules(5), shorewall\-routestopped(5), shorewall\-rules(5), shorewall\&.conf(5), shorewall\-tcclasses(5), shorewall\-tcdevices(5), shorewall\-tcrules(5), shorewall\-tos(5), shorewall\-tunnels(5), shorewall\-zones(5)
.SH "NOTES"
.IP " 1." 4
shorewall-hosts
.RS 4
\%shorewall-hosts.html
.RE
.IP " 2." 4
shorewall-nesting
.RS 4
\%shorewall-nesting.html
.RE
.IP " 3." 4
Proxy ARP
.RS 4
\%../ProxyARP.htm
.RE
.IP " 4." 4
shorewall-blacklist
.RS 4
\%shorewall-blacklist.html
.RE
.IP " 5." 4
simple bridge
.RS 4
\%../SimpleBridge.html
.RE
.IP " 6." 4
Shorewall-perl for firewall/bridging
.RS 4
\%../bridge-Shorewall-perl.html
.RE
.IP " 7." 4
shorewall-rules
.RS 4
\%shorewall-rules.html
.RE
.IP " 8." 4
shorewall.conf
.RS 4
\%shorewall.conf.html
.RE
.IP " 9." 4
shorewall-maclist
.RS 4
\%shorewall-maclist.html
.RE
.IP "10." 4
shorewall-proxyarp
.RS 4
\%shorewall-proxyarp.html
.RE
.IP "11." 4
http://tldp.org/HOWTO/Proxy-ARP-Subnet/index.html.
.RS 4
\%http://tldp.org/HOWTO/Proxy-ARP-Subnet/index.html
.RE
.IP "12." 4
http://www.shorewall.net/UPnP.html
.RS 4
\%../UPnP.html
.RE
